"0","rm(list = ls()); invisible(gc())"
"0",""
"0","gen_geo <- function(img, x1, y1, x2, y2){"
"0","    img_info <- image_info(img)"
"0","    res <- paste0((x2-x1)/33.87*img_info$width, ""x"", "
"0","                  (y2-y1)/19.05*img_info$height, ""+"", "
"0","                  (x1)/33.87*img_info$width, ""+"", "
"0","                  (y1)/19.05*img_info$height)"
"0","    return(res)"
"0","}"
"0",""
"0","gen_img.name <- function(path_img_all, path_dir_fix){"
"0","      img_num <- length(path_img_all)"
"0","      num_digit <- img_num %>% nchar()"
"0","      tmp <- paste(""img"", formatC(1:img_num, width = num_digit, flag = ""0""), sep = ""_"")"
"0","      img_ext <- file_ext(path_img_all) %>% tolower()"
"0","      img_nn <- paste0(path_dir_fix, ""/"", tmp, ""."", img_ext)"
"0","      return(img_nn)"
"0","}"
"0",""
"0",""
"0","path_dir_ori <- list.dirs(path = ""../slide_ori"")[-1]"
"0","for (i_dir in 1:length(path_dir_ori)) {"
"0","  img_all <- list()"
"0","  "
"0","  # meta info"
"0","  x1 <- 1.33; y1 <- 3.06"
"0","  x2 <- 27.28; y2 <- 17.68"
"0","  "
"0","  "
"0","  # read and cut image"
"0","  path_img_all <- list.files(path_dir_ori[i_dir], full.names = T) %>% mixedsort()"
"0","  for (i_img in 1:length(path_img_all)) {"
"0","    img <- image_read(path_img_all[i_img])"
"0","    img_fix <- image_crop(image = img, geometry = gen_geo(img, x1, y1, x2, y2))"
"0","    img_all <- list.append(img_all, img_fix)"
"0","  }"
"0","  "
"0","  # save image"
"0","  path_img_all_fix <- path_img_all %>% gsub(""slide_ori"", ""slide_fix"", .)"
"0","  path_dir_fix <- path_img_all_fix[1] %>% dirname()"
"0","  if (!dir.exists(path_dir_fix)) dir.create(path = path_dir_fix, recursive = T)"
"0","  img_nn <- gen_img.name(path_img_all, path_dir_fix)"
"0","  for (i_img in 1:length(path_img_all)) {"
"0","    image_write(image = img_all[[i_img]], path = img_nn[i_img])"
"0","  }"
"0","}"
"0",""
"0",""
